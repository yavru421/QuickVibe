(self.webpackChunk_voila_dashboards_widgets_manager7=self.webpackChunk_voila_dashboards_widgets_manager7||[]).push([[613],{4613:(e,t,s)=>{"use strict";s.r(t),s.d(t,{CONTROL_COMM_PROTOCOL_VERSION:()=>j,CONTROL_COMM_TARGET:()=>O,CONTROL_COMM_TIMEOUT:()=>P,DOMWidgetModel:()=>H,DOMWidgetView:()=>K,IJupyterWidgetRegistry:()=>se,JUPYTER_WIDGETS_VERSION:()=>x,JupyterPhosphorPanelWidget:()=>q,JupyterPhosphorWidget:()=>J,LayoutModel:()=>Y,LayoutView:()=>X,ManagerBase:()=>A,PROTOCOL_VERSION:()=>k,StyleModel:()=>Q,StyleView:()=>Z,ViewList:()=>te,WidgetModel:()=>W,WidgetView:()=>V,WrappedError:()=>m,assign:()=>u,base64ToBuffer:()=>E,bufferToBase64:()=>b,bufferToHex:()=>y,difference:()=>h,hexToBuffer:()=>w,isEqual:()=>c,pack_models:()=>U,put_buffers:()=>g,reject:()=>f,remove_buffers:()=>p,resolvePromisesDict:()=>_,serialize_state:()=>S,shims:()=>ee,unpack_models:()=>L,uuid:()=>d});var i=s(7991),n=s(7262),r=s(6343),o=s.n(r),a=s(8360),l=s.n(a);function h(e,t){return e.filter((e=>-1===t.indexOf(e)))}function c(e,t){return o()(e,t)}let u=Object.assign||function(e){for(let t=1;t<arguments.length;t++){let s=arguments[t];for(let t in s)Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=s[t])}return e};function d(){return n.UUID.uuid4()}class m extends Error{constructor(e,t){super(e),console.warn("WrappedError has been deprecated!"),this.error_stack=t instanceof m?t.error_stack:[t],this.error_stack.push(this)}}function _(e){let t=Object.keys(e),s=[];return t.forEach((function(t){s.push(e[t])})),Promise.all(s).then((e=>{let s={};for(let i=0;i<t.length;i++)s[t[i]]=e[i];return s}))}function f(e,t){return function(s){throw t&&console.error(new Error(e)),s}}function g(e,t,s){for(let i=0;i<t.length;i++){let n=t[i],r=e;for(let e=0;e<n.length-1;e++)r=r[n[e]];r[n[n.length-1]]=s[i]}}function p(e){let t=[],s=[];return{state:function e(i,n){if(i.toJSON&&(i=i.toJSON()),Array.isArray(i)){let r=!1;for(let o=0;o<i.length;o++){let a=i[o];if(a)if(a instanceof ArrayBuffer||ArrayBuffer.isView(a))r||(i=i.slice(),r=!0),t.push(ArrayBuffer.isView(a)?a.buffer:a),s.push(n.concat([o])),i[o]=null;else{let t=e(a,n.concat([o]));t!==a&&(r||(i=i.slice(),r=!0),i[o]=t)}}}else if(l()(i))for(let r in i){let o=!1;if(i.hasOwnProperty(r)){let a=i[r];if(a)if(a instanceof ArrayBuffer||ArrayBuffer.isView(a))o||(i=Object.assign({},i),o=!0),t.push(ArrayBuffer.isView(a)?a.buffer:a),s.push(n.concat([r])),delete i[r];else{let t=e(a,n.concat([r]));t!==a&&(o||(i=Object.assign({},i),o=!0),i[r]=t)}}}return i}(e,[]),buffers:t,buffer_paths:s}}let v=["00","01","02","03","04","05","06","07","08","09","0A","0B","0C","0D","0E","0F","10","11","12","13","14","15","16","17","18","19","1A","1B","1C","1D","1E","1F","20","21","22","23","24","25","26","27","28","29","2A","2B","2C","2D","2E","2F","30","31","32","33","34","35","36","37","38","39","3A","3B","3C","3D","3E","3F","40","41","42","43","44","45","46","47","48","49","4A","4B","4C","4D","4E","4F","50","51","52","53","54","55","56","57","58","59","5A","5B","5C","5D","5E","5F","60","61","62","63","64","65","66","67","68","69","6A","6B","6C","6D","6E","6F","70","71","72","73","74","75","76","77","78","79","7A","7B","7C","7D","7E","7F","80","81","82","83","84","85","86","87","88","89","8A","8B","8C","8D","8E","8F","90","91","92","93","94","95","96","97","98","99","9A","9B","9C","9D","9E","9F","A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","AA","AB","AC","AD","AE","AF","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","BA","BB","BC","BD","BE","BF","C0","C1","C2","C3","C4","C5","C6","C7","C8","C9","CA","CB","CC","CD","CE","CF","D0","D1","D2","D3","D4","D5","D6","D7","D8","D9","DA","DB","DC","DD","DE","DF","E0","E1","E2","E3","E4","E5","E6","E7","E8","E9","EA","EB","EC","ED","EE","EF","F0","F1","F2","F3","F4","F5","F6","F7","F8","F9","FA","FB","FC","FD","FE","FF"];function y(e){let t=new Uint8Array(e),s=[];for(let e=0;e<t.length;e++)s.push(v[t[e]]);return s.join("")}function w(e){let t=new Uint8Array(e.length/2);for(let s=0;s<e.length;s+=2)t[s/2]=parseInt(e.slice(s,s+2),16);return t.buffer}function b(e){return(0,i.iI)(new Uint8Array(e))}function E(e){return(0,i.bg)(e).buffer}const x="1.2.0",k="2.1.0",C=k.split(".",1)[0],O="jupyter.widget.control",j="1.0.0",P=4e3;class A{constructor(){this.comm_target_name="jupyter.widget",this._models=Object.create(null)}display_model(e,t,s={}){return this.create_view(t,s).then((t=>this.display_view(e,t,s))).catch(f("Could not create view",!0))}setViewOptions(e={}){return e}create_view(e,t={}){let s=e.state_change=e.state_change.then((()=>this.loadClass(e.get("_view_name"),e.get("_view_module"),e.get("_view_module_version")).then((s=>{let i=new s({model:e,options:this.setViewOptions(t)});return i.listenTo(e,"destroy",i.remove),Promise.resolve(i.render()).then((()=>i))})).catch(f("Could not create a view for model id "+e.model_id,!0)))),i=d();return e.views[i]=s,s.then((e=>{e.once("remove",(()=>{delete e.model.views[i]}),this)})),e.state_change}callbacks(e){return{}}get_model(e){return this._models[e]}has_model(e){return void 0!==this._models[e]}handle_comm_open(e,t){let s=(t.metadata||{}).version||"";if(s.split(".",1)[0]!==C){let e=`Wrong widget protocol version: received protocol version '${s}', but was expecting major version '${C}'`;return console.error(e),Promise.reject(e)}let i=t.content.data,n=i.buffer_paths||[],r=(t.buffers||[]).map((e=>e instanceof DataView?e:new DataView(e instanceof ArrayBuffer?e:e.buffer)));return g(i.state,n,r),this.new_model({model_name:i.state._model_name,model_module:i.state._model_module,model_module_version:i.state._model_module_version,comm:e},i.state).catch(f("Could not create a model.",!0))}new_widget(e,t={}){let s;if(void 0===e.view_name||void 0===e.view_module||void 0===e.view_module_version)return Promise.reject("new_widget(...) must be given view information in the options.");s=e.comm?Promise.resolve(e.comm):this._create_comm(this.comm_target_name,e.model_id,{state:{_model_module:e.model_module,_model_module_version:e.model_module_version,_model_name:e.model_name,_view_module:e.view_module,_view_module_version:e.view_module_version,_view_name:e.view_name}},{version:k});let i=Object.assign({},e);return s.then((e=>(i.comm=e,this.new_model(i,t).then((e=>(e.sync("create",e),e))))),(()=>(i.model_id||(i.model_id=d()),this.new_model(i,t))))}register_model(e,t){this._models[e]=t,t.then((t=>{t.once("comm:close",(()=>{delete this._models[e]}))}))}async new_model(e,t={}){let s;if(e.model_id)s=e.model_id;else{if(!e.comm)throw new Error("Neither comm nor model_id provided in options object. At least one must exist.");s=e.model_id=e.comm.comm_id}let i=this._make_model(e,t);return this.register_model(s,i),await i}async _make_model(e,t={}){let s,i=e.model_id,n=this.loadClass(e.model_name,e.model_module,e.model_module_version);try{s=await n}catch(e){throw console.error("Could not instantiate widget"),e}if(!s)throw new Error(`Cannot find model module ${e.model_module}@${e.model_module_version}, ${e.model_name}`);let r=await s._deserialize_state(t,this),o=new s(r,{widget_manager:this,model_id:i,comm:e.comm});return o.name=e.model_name,o.module=e.model_module,o}async _loadFromKernel(){let e,t;try{const s=await this._create_comm(O,d(),{},{version:j});await new Promise(((i,n)=>{s.on_msg((s=>{e=s.content.data,"update_states"===e.method?(t=(s.buffers||[]).map((e=>e instanceof DataView?e:new DataView(e instanceof ArrayBuffer?e:e.buffer))),i(null)):console.warn(`\n                        Unknown ${e.method} message on the Control channel\n                        `)})),s.on_close((()=>n("Control comm was closed too early"))),s.send({method:"request_states"},{}),setTimeout((()=>n("Control comm did not respond in time")),P)})),s.close()}catch(e){return console.warn('Failed to fetch ipywidgets through the "jupyter.widget.control" comm channel, fallback to fetching individual model state. Reason:',e),this._loadFromKernelModels()}const s=e.states,i={},n={};for(let s=0;s<e.buffer_paths.length;s++){const[r,...o]=e.buffer_paths[s],a=t[s];i[r]||(i[r]=[],n[r]=[]),i[r].push(o),n[r].push(a)}let r=await Promise.all(Object.keys(s).map((async e=>({widget_id:e,comm:this.has_model(e)?void 0:await this._create_comm("jupyter.widget",e)}))));await Promise.all(r.map((async({widget_id:e,comm:t})=>{const r=s[e];e in i&&g(r,i[e],n[e]);try{if(t)await this.new_model({model_name:r.model_name,model_module:r.model_module,model_module_version:r.model_module_version,model_id:e,comm:t},r.state);else{const t=await this.get_model(e),s=await t.constructor._deserialize_state(r.state,this);t.set_state(s)}}catch(e){console.error(e)}})))}async _loadFromKernelModels(){const e=await this._get_comm_info(),t=await Promise.all(Object.keys(e).map((async e=>{if(this.has_model(e))return;const t=await this._create_comm(this.comm_target_name,e);let s="";const i=new n.PromiseDelegate;return t.on_msg((e=>{if(e.parent_header.msg_id===s&&"comm_msg"===e.header.msg_type&&"update"===e.content.data.method){const s=e.content.data,n=s.buffer_paths||[],r=e.buffers||[];g(s.state,n,r),i.resolve({comm:t,msg:e})}})),s=t.send({method:"request_state"},this.callbacks(void 0)),i.promise})));await Promise.all(t.map((async e=>{if(!e)return;const t=e.msg.content;await this.new_model({model_name:t.data.state._model_name,model_module:t.data.state._model_module,model_module_version:t.data.state._model_module_version,comm:e.comm},t.data.state)})))}clear_state(){return _(this._models).then((e=>{Object.keys(e).forEach((t=>e[t].close())),this._models=Object.create(null)}))}get_state(e={}){const t=Object.keys(this._models).map((e=>this._models[e]));return Promise.all(t).then((t=>S(t,e)))}set_state(e){if(!(e.version_major&&e.version_major<=2))throw"Unsupported widget state format";let t=e.state;return this._get_comm_info().then((e=>Promise.all(Object.keys(t).map((s=>{let i={base64:E,hex:w},n=t[s],r=n.state;if(n.buffers){let e=n.buffers.map((e=>e.path)),t=n.buffers.map((e=>new DataView(i[e.encoding](e.data))));g(n.state,e,t)}if(this.has_model(s))return this.get_model(s).then((e=>e.constructor._deserialize_state(r||{},this).then((t=>(e.set_state(t),e)))));let o={model_id:s,model_name:n.model_name,model_module:n.model_module,model_module_version:n.model_module_version};return e.hasOwnProperty(s)?this._create_comm(this.comm_target_name,s).then((e=>(o.comm=e,this.new_model(o)))):this.new_model(o,r)})))))}disconnect(){Object.keys(this._models).forEach((e=>{this._models[e].then((e=>{e.comm_live=!1}))}))}resolveUrl(e){return Promise.resolve(e)}filterExistingModelState(e){let t=e.state;return t=Object.keys(t).filter((e=>!this.has_model(e))).reduce(((e,s)=>(e[s]=t[s],e)),{}),Object.assign(Object.assign({},e),{state:t})}}function S(e,t={}){const s={};return e.forEach((e=>{const i=e.model_id,n=p(e.serialize(e.get_state(t.drop_defaults))),r=n.buffers.map(((e,t)=>({data:b(e),path:n.buffer_paths[t],encoding:"base64"})));s[i]={model_name:e.name,model_module:e.module,model_module_version:e.get("_model_module_version"),state:n.state},r.length>0&&(s[i].buffers=r)})),{version_major:2,version_minor:0,state:s}}function M(e,t,s){if(null==e)return this;let i;if("object"==typeof e?(i=e,s=t):(i={})[e]=t,s||(s={}),!this._validate(i,s))return!1;let n=s.unset,r=s.silent,o=[],a=this._changing;this._changing=!0;try{a||(this._previousAttributes=Object.assign({},this.attributes),this.changed={});let e=this.attributes,l=this.changed,h=this._previousAttributes;for(let s in i)t=i[s],c(e[s],t)||o.push(s),c(h[s],t)?delete l[s]:l[s]=t,n?delete e[s]:e[s]=t;if(this.id=this.get(this.idAttribute),!r){o.length&&(this._pending=s);for(let t=0;t<o.length;t++)this.trigger("change:"+o[t],this,e[o[t]],s)}if(a)return this;if(!r)for(;this._pending;)s=this._pending,this._pending=!1,this.trigger("change",this,s)}finally{this._pending=!1,this._changing=!1}return this}var T=s(3722),I=s(4651),D=s.n(I);const B=Element.prototype;let N=B.matches||B.webkitMatchesSelector||B.mozMatchesSelector||B.msMatchesSelector||B.oMatchesSelector||function(e){let t=(this.document||this.ownerDocument).querySelectorAll(e),s=t.length;for(;--s>=0&&t.item(s)!==this;);return s>-1};class F extends T.View{_removeElement(){this.undelegateEvents(),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}_setElement(e){this.el=e}_setAttributes(e){for(let t in e)t in this.el?this.el[t]=e[t]:this.el.setAttribute(t,e[t])}delegate(e,t,s){"string"!=typeof t&&(s=t,t=null),void 0===this._domEvents&&(this._domEvents=[]);let i=this.el,n=t?function(e){let n=e.target||e.srcElement;for(;n&&n!==i;n=n.parentNode)if(N.call(n,t))return e.delegateTarget=n,s.handleEvent?s.handleEvent(e):s(e)}:s;return this.el.addEventListener(e,n,!1),this._domEvents.push({eventName:e,handler:n,listener:s,selector:t}),n}undelegate(e,t,s){if("function"==typeof t&&(s=t,t=null),this.el&&this._domEvents){let i=this._domEvents.slice(),n=i.length;for(;n--;){let r=i[n];!(r.eventName!==e||s&&r.listener!==s||t&&r.selector!==t)&&(this.el.removeEventListener(r.eventName,r.handler,!1),this._domEvents.splice(n,1))}}return this}undelegateEvents(){if(this.el&&this._domEvents){let e=this._domEvents.length;for(let t=0;t<e;t++){let e=this._domEvents[t];this.el.removeEventListener(e.eventName,e.handler,!1)}this._domEvents.length=0}return this}}var z=s(5256),$=s(6230);const R="IPY_MODEL_";function L(e,t){if(Array.isArray(e)){const s=[];return e.forEach(((e,i)=>{s.push(L(e,t))})),Promise.all(s)}if(e instanceof Object){const s={};return Object.keys(e).forEach((i=>{s[i]=L(e[i],t)})),_(s)}return"string"==typeof e&&"IPY_MODEL_"===e.slice(0,10)?t.get_model(e.slice(10,e.length)):Promise.resolve(e)}function U(e,t){if(Array.isArray(e)){const s=[];for(const i of e)s.push(U(i,t));return s}if(e instanceof W)return`${R}${e.model_id}`;if(!(e instanceof Object&&"string"!=typeof e))return e;{const s={};Object.keys(e).forEach((i=>{s[i]=U(e[i],t)}))}}class W extends T.Model{defaults(){return{_model_module:"@jupyter-widgets/base",_model_name:"WidgetModel",_model_module_version:x,_view_module:"@jupyter-widgets/base",_view_name:null,_view_module_version:x,_view_count:null}}isNew(){return!1}initialize(e,t){this._expectedEchoMsgIds={},this._attrsToUpdate={},super.initialize(e,t),this.widget_manager=t.widget_manager,this.model_id=t.model_id;let s=t.comm;this.views=Object.create(null),this.state_change=Promise.resolve(),this._closed=!1,this._state_lock=null,this._msg_buffer=null,this._msg_buffer_callbacks=null,this._pending_msgs=0,this._buffered_state_diff={},s?(this.comm=s,s.on_close(this._handle_comm_closed.bind(this)),s.on_msg(this._handle_comm_msg.bind(this)),this.comm_live=!0):this.comm_live=!1}get comm_live(){return this._comm_live}set comm_live(e){this._comm_live=e,this.trigger("comm_live_update")}send(e,t,s){if(void 0!==this.comm){let i={method:"custom",content:e};this.comm.send(i,t,{},s)}}close(e=!1){if(this._closed)return;this._closed=!0,this.comm&&!e&&this.comm.close(),this.stopListening(),this.trigger("destroy",this),this.comm&&delete this.comm;let t=Object.keys(this.views).map((e=>this.views[e].then((e=>e.remove()))));return delete this.views,Promise.all(t).then((()=>{}))}_handle_comm_closed(e){this.trigger("comm:close"),this.close(!0)}_handle_comm_msg(e){const t=e.content.data;let s=t.method;switch(s){case"update":case"echo_update":return this.state_change=this.state_change.then((()=>{var i,n,r;let o=t.state,a=null!=(i=t.buffer_paths)?i:[],l=(r=null===(n=e.buffers)||void 0===n?void 0:n.slice(0,a.length),null!=r?r:[]).map((e=>e instanceof DataView?e:new DataView(e instanceof ArrayBuffer?e:e.buffer)));if(g(o,a,l),e.parent_header&&"echo_update"===s){const t=e.parent_header.msg_id;Object.keys(o).filter((e=>this._expectedEchoMsgIds.hasOwnProperty(e))).forEach((e=>{this._expectedEchoMsgIds[e]!==t?delete o[e]:(delete this._expectedEchoMsgIds[e],null!==this._msg_buffer&&Object.prototype.hasOwnProperty.call(this._msg_buffer,e)&&delete o[e])}))}return this.constructor._deserialize_state(o,this.widget_manager)})).then((e=>{this.set_state(e)})).catch(f(`Could not process update msg for model id: ${this.model_id}`,!0)),this.state_change;case"custom":return this.trigger("msg:custom",t.content,e.buffers),Promise.resolve()}}set_state(e){this._state_lock=e;try{this.set(e)}catch(e){console.error(`Error setting state: ${e.message}`)}finally{this._state_lock=null}}get_state(e){let t=this.attributes;if(e){let e=this.defaults,s="function"==typeof e?e.call(this):e,i={};return Object.keys(t).forEach((e=>{c(t[e],s[e])||(i[e]=t[e])})),i}return Object.assign({},t)}_handle_status(e){if(void 0!==this.comm&&"idle"===e.content.execution_state&&(this._pending_msgs--,this._pending_msgs<0&&(console.error(`Jupyter Widgets message throttle: Pending messages < 0 (=${this._pending_msgs}), which is unexpected. Resetting to 0 to continue.`),this._pending_msgs=0),null!==this._msg_buffer&&this._pending_msgs<1)){const e=this.send_sync_message(this._msg_buffer,this._msg_buffer_callbacks);this.rememberLastUpdateFor(e),this._msg_buffer=null,this._msg_buffer_callbacks=null}}callbacks(e){return this.widget_manager.callbacks(e)}set(e,t,s){let i=M.call(this,e,t,s);if(void 0!==this._buffered_state_diff){let e=this.changedAttributes()||{};if(this._state_lock)for(const t of Object.keys(this._state_lock))e[t]===this._state_lock[t]&&delete e[t];this._buffered_state_diff=u(this._buffered_state_diff,e)}return i}sync(e,t,s={}){if(void 0===this.comm)throw"Syncing error: no comm channel defined";let i="patch"===e?s.attrs:t.get_state(s.drop_defaults);if(this._state_lock)for(const e of Object.keys(this._state_lock))i[e]===this._state_lock[e]&&delete i[e];Object.keys(i).forEach((e=>{this._attrsToUpdate[e]=!0}));let n=this.serialize(i);if(Object.keys(n).length>0){let t=s.callbacks||this.callbacks();if(this._pending_msgs>=1){switch(e){case"patch":this._msg_buffer=u(this._msg_buffer||{},n);break;case"update":case"create":this._msg_buffer=n;break;default:throw"unrecognized syncing method"}this._msg_buffer_callbacks=t}else{const e=this.send_sync_message(i,t);this.rememberLastUpdateFor(e)}}}rememberLastUpdateFor(e){Object.keys(this._attrsToUpdate).forEach((t=>{this._expectedEchoMsgIds[t]=e})),this._attrsToUpdate={}}serialize(e){const t=this.constructor.serializers||{};for(const s of Object.keys(e))try{t[s]&&t[s].serialize?e[s]=t[s].serialize(e[s],this):e[s]=JSON.parse(JSON.stringify(e[s])),e[s]&&e[s].toJSON&&(e[s]=e[s].toJSON())}catch(e){throw console.error("Error serializing widget state attribute: ",s),e}return e}send_sync_message(e,t={}){if(!this.comm)return"";try{const s=(t={shell:Object.assign({},t.shell),iopub:Object.assign({},t.iopub),input:t.input}).iopub.status;t.iopub.status=e=>{this._handle_status(e),s&&s(e)};let i=p(e);const n=this.comm.send({method:"update",state:i.state,buffer_paths:i.buffer_paths},t,{},i.buffers);return this._pending_msgs++,n}catch(e){console.error("Could not send widget sync message",e)}return""}save_changes(e){if(this.comm_live){let t={patch:!0};e&&(t.callbacks=e),this.save(this._buffered_state_diff,t),this._buffered_state_diff={}}}on_some_change(e,t,s){const i=this;this.on("change",(function(){e.some(i.hasChanged,i)&&t.apply(s,arguments)}),this)}toJSON(e){return`IPY_MODEL_${this.model_id}`}static _deserialize_state(e,t){let s,i=this.serializers;if(i){s={};for(let n in e)i[n]&&i[n].deserialize?s[n]=i[n].deserialize(e[n],t):s[n]=e[n]}else s=e;return _(s)}}class H extends W{defaults(){return u(super.defaults(),{_dom_classes:[]})}}H.serializers=Object.assign(Object.assign({},W.serializers),{layout:{deserialize:L},style:{deserialize:L}});class V extends F{constructor(e){super(e)}initialize(e){this.listenTo(this.model,"change",(()=>{let e=Object.keys(this.model.changedAttributes()||{});"_view_count"===e[0]&&1===e.length||this.update()})),this.options=e.options,this.once("remove",(()=>{"number"==typeof this.model.get("_view_count")&&(this.model.set("_view_count",this.model.get("_view_count")-1),this.model.save_changes())})),this.once("displayed",(()=>{"number"==typeof this.model.get("_view_count")&&(this.model.set("_view_count",this.model.get("_view_count")+1),this.model.save_changes())})),this.displayed=new Promise(((e,t)=>{this.once("displayed",e)}))}update(e){}render(){}create_child_view(e,t={}){return t=Object.assign({parent:this},t),this.model.widget_manager.create_view(e,t).catch(f("Could not create child view",!0))}callbacks(){return this.model.callbacks(this)}send(e,t){this.model.send(e,this.callbacks(),t)}touch(){this.model.save_changes(this.callbacks())}remove(){return super.remove(),this.trigger("remove"),this}}class J extends z.Widget{constructor(e){let t=e.view;delete e.view,super(e),this._view=t}dispose(){this.isDisposed||(super.dispose(),this._view&&this._view.remove(),this._view=null)}processMessage(e){super.processMessage(e),this._view.processPhosphorMessage(e)}}class q extends z.Panel{constructor(e){let t=e.view;delete e.view,super(e),this._view=t}processMessage(e){super.processMessage(e),this._view.processPhosphorMessage(e)}dispose(){this.isDisposed||(super.dispose(),this._view&&this._view.remove(),this._view=null)}}class K extends V{initialize(e){super.initialize(e),this.listenTo(this.model,"change:_dom_classes",((e,t)=>{let s=e.previous("_dom_classes");this.update_classes(s,t)})),this.layoutPromise=Promise.resolve(),this.listenTo(this.model,"change:layout",((e,t)=>{this.setLayout(t,e.previous("layout"))})),this.stylePromise=Promise.resolve(),this.listenTo(this.model,"change:style",((e,t)=>{this.setStyle(t,e.previous("style"))})),this.displayed.then((()=>{this.update_classes([],this.model.get("_dom_classes")),this.setLayout(this.model.get("layout")),this.setStyle(this.model.get("style"))})),this._comm_live_update(),this.listenTo(this.model,"comm_live_update",(()=>{this._comm_live_update()}))}setLayout(e,t){e&&(this.layoutPromise=this.layoutPromise.then((t=>(t&&(t.unlayout(),this.stopListening(t.model),t.remove()),this.create_child_view(e).then((e=>this.displayed.then((()=>(e.trigger("displayed"),this.listenTo(e.model,"change",(()=>{$.MessageLoop.postMessage(this.pWidget,z.Widget.ResizeMessage.UnknownSize)})),$.MessageLoop.postMessage(this.pWidget,z.Widget.ResizeMessage.UnknownSize),e))))).catch(f("Could not add LayoutView to DOMWidgetView",!0))))))}setStyle(e,t){e&&(this.stylePromise=this.stylePromise.then((t=>(t&&(t.unstyle(),this.stopListening(t.model),t.remove()),this.create_child_view(e).then((e=>this.displayed.then((()=>(e.trigger("displayed"),e))))).catch(f("Could not add styleView to DOMWidgetView",!0))))))}update_classes(e,t,s){void 0===s&&(s=this.el),h(e,t).map((function(e){s.classList?s.classList.remove(e):s.setAttribute("class",s.getAttribute("class").replace(e,""))})),h(t,e).map((function(e){s.classList?s.classList.add(e):s.setAttribute("class",s.getAttribute("class").concat(" ",e))}))}update_mapped_classes(e,t,s){let i=this.model.previous(t),n=e[i]?e[i]:[];i=this.model.get(t);let r=e[i]?e[i]:[];this.update_classes(n,r,s||this.el)}set_mapped_classes(e,t,s){let i=this.model.get(t),n=e[i]?e[i]:[];this.update_classes([],n,s||this.el)}_setElement(e){this.pWidget&&this.pWidget.dispose(),this.$el=e instanceof D()?e:D()(e),this.el=this.$el[0],this.pWidget=new J({node:e,view:this})}remove(){return this.pWidget&&this.pWidget.dispose(),super.remove()}processPhosphorMessage(e){"after-attach"===e.type&&this.trigger("displayed")}_comm_live_update(){this.model.comm_live?this.pWidget.removeClass("jupyter-widgets-disconnected"):this.pWidget.addClass("jupyter-widgets-disconnected")}}let G={align_content:null,align_items:null,align_self:null,border:null,bottom:null,display:null,flex:null,flex_flow:null,height:null,justify_content:null,justify_items:null,left:null,margin:null,max_height:null,max_width:null,min_height:null,min_width:null,overflow:null,overflow_x:null,overflow_y:null,order:null,padding:null,right:null,top:null,visibility:null,width:null,object_fit:null,object_position:null,grid_auto_columns:null,grid_auto_flow:null,grid_auto_rows:null,grid_gap:null,grid_template_rows:null,grid_template_columns:null,grid_template_areas:null,grid_row:null,grid_column:null,grid_area:null};class Y extends W{defaults(){return u(super.defaults(),{_model_name:"LayoutModel",_view_name:"LayoutView"},G)}}class X extends V{initialize(e){this._traitNames=[],super.initialize(e);for(let e of Object.keys(G))this.registerTrait(e)}registerTrait(e){if(this._traitNames.push(e),"overflow_x"===e||"overflow_y"===e)return this.listenTo(this.model,"change:"+e,((t,s)=>{this.handleOverflowChange(e,s)})),void this.handleOverflowChange(e,this.model.get(e));this.listenTo(this.model,"change:"+e,((t,s)=>{this.handleChange(e,s)})),this.handleChange(e,this.model.get(e))}css_name(e){return e.replace(/_/g,"-")}handleChange(e,t){let s=this.options.parent;s?null===t?s.el.style.removeProperty(this.css_name(e)):s.el.style[this.css_name(e)]=t:console.warn("Style not applied because a parent view does not exist")}handleOverflowChange(e,t){let s=this.options.parent;s?null===t?null===this.model.get("overflow")&&s.el.style.removeProperty(this.css_name(e)):s.el.style[this.css_name(e)]=t:console.warn("Style not applied because a parent view does not exist")}unlayout(){let e=this.options.parent;this._traitNames.forEach((t=>{e?e.el.style.removeProperty(this.css_name(t)):console.warn("Style not removed because a parent view does not exist")}),this)}}class Q extends W{defaults(){let e=this.constructor;return u(super.defaults(),{_model_name:"StyleModel",_view_name:"StyleView"},Object.keys(e.styleProperties).reduce(((t,s)=>(t[s]=e.styleProperties[s].default,t)),{}))}}Q.styleProperties={};class Z extends V{initialize(e){this._traitNames=[],super.initialize(e);let t=this.model.constructor;for(let e of Object.keys(t.styleProperties))this.registerTrait(e);this.style()}registerTrait(e){this._traitNames.push(e),this.listenTo(this.model,"change:"+e,((t,s)=>{this.handleChange(e,s)}))}handleChange(e,t){let s=this.options.parent;if(s){let i=this.model.constructor.styleProperties,n=i[e].attribute,r=i[e].selector,o=r?s.el.querySelectorAll(r):[s.el];if(null===t)for(let e=0;e!==o.length;++e)o[e].style.removeProperty(n);else for(let e=0;e!==o.length;++e)o[e].style[n]=t}else console.warn("Style not applied because a parent view does not exist")}style(){for(let e of this._traitNames)this.handleChange(e,this.model.get(e))}unstyle(){let e=this.options.parent,t=this.model.constructor.styleProperties;this._traitNames.forEach((s=>{if(e){let i=t[s].attribute,n=t[s].selector,r=n?e.el.querySelectorAll(n):[e.el];for(let e=0;e!==r.length;++e)r[e].style.removeProperty(i)}else console.warn("Style not removed because a parent view does not exist")}),this)}}var ee;!function(e){let t;!function(e){e.CommManager=class{constructor(e){this.targets=Object.create(null),this.comms=Object.create(null),this.kernel=null,this.jsServicesKernel=null,this.init_kernel(e)}init_kernel(e){this.kernel=e,this.jsServicesKernel=e}async new_comm(e,s,i,n,r,o){let a=this.jsServicesKernel.createComm(e,r),l=new t(a);return this.register_comm(l),l.open(s,i,n,o),l}register_target(e,s){let i=this.jsServicesKernel.registerCommTarget(e,((e,i)=>{let n=new t(e);this.register_comm(n);try{return s(n,i)}catch(e){n.close(),console.error(e),console.error(new Error("Exception opening new comm"))}}));this.targets[e]=i}unregister_target(e,t){this.targets[e].dispose(),delete this.targets[e]}register_comm(e){return this.comms[e.comm_id]=Promise.resolve(e),e.kernel=this.kernel,e.comm_id}};class t{constructor(e){this.jsServicesComm=null,this.kernel=null,this.jsServicesComm=e}get comm_id(){return this.jsServicesComm.commId}get target_name(){return this.jsServicesComm.targetName}open(e,t,s,i){let n=this.jsServicesComm.open(e,s,i);return this._hookupCallbacks(n,t),n.msg.header.msg_id}send(e,t,s,i){let n=this.jsServicesComm.send(e,s,i);return this._hookupCallbacks(n,t),n.msg.header.msg_id}close(e,t,s,i){let n=this.jsServicesComm.close(e,s,i);return this._hookupCallbacks(n,t),n.msg.header.msg_id}on_msg(e){this.jsServicesComm.onMsg=e.bind(this)}on_close(e){this.jsServicesComm.onClose=e.bind(this)}_hookupCallbacks(e,t){t&&(e.onReply=function(e){t.shell&&t.shell.reply&&t.shell.reply(e)},e.onStdin=function(e){t.input&&t.input(e)},e.onIOPub=function(e){if(t.iopub)if(t.iopub.status&&"status"===e.header.msg_type)t.iopub.status(e);else if(t.iopub.clear_output&&"clear_output"===e.header.msg_type)t.iopub.clear_output(e);else if(t.iopub.output)switch(e.header.msg_type){case"display_data":case"execute_result":case"stream":case"error":t.iopub.output(e)}})}}e.Comm=t}(t=e.services||(e.services={}))}(ee||(ee={}));class te{constructor(e,t,s){this.initialize(e,t,s)}initialize(e,t,s){this._handler_context=s||this,this._models=[],this.views=[],this._create_view=e,this._remove_view=t||function(e){e.remove()}}update(e,t,s,i){let n=s||this._remove_view,r=t||this._create_view;i=i||this._handler_context;let o=0;for(;o<e.length&&!(o>=this._models.length||e[o]!==this._models[o]);o++);let a=o,l=this.views.splice(a,this.views.length-a);for(let e=0;e<l.length;e++)l[e].then((function(e){n.call(i,e)}));for(;o<e.length;o++)this.views.push(Promise.resolve(r.call(i,e[o],o)));return this._models=e.slice(),Promise.all(this.views)}remove(){return Promise.all(this.views).then((e=>{e.forEach((e=>this._remove_view.call(this._handler_context,e))),this.views=[],this._models=[]}))}dispose(){this.views=null,this._models=null}}const se=new n.Token("jupyter.extensions.jupyterWidgetRegistry")},3722:(e,t,s)=>{var i,n,r;r="object"==typeof self&&self.self==self&&self||"object"==typeof s.g&&s.g.global==s.g&&s.g,i=[s(7941),s(4651),t],n=function(e,t,s){r.Backbone=function(e,t,s,i){var n=e.Backbone,r=Array.prototype.slice;t.VERSION="1.2.3",t.$=i,t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=function(e,t,i){s.each(t,(function(t,n){s[n]&&(e.prototype[n]=function(e,t,i){switch(e){case 1:return function(){return s[t](this[i])};case 2:return function(e){return s[t](this[i],e)};case 3:return function(e,n){return s[t](this[i],a(e,this),n)};case 4:return function(e,n,r){return s[t](this[i],a(e,this),n,r)};default:return function(){var e=r.call(arguments);return e.unshift(this[i]),s[t].apply(s,e)}}}(t,n,i))}))},a=function(e,t){return s.isFunction(e)?e:s.isObject(e)&&!t._isModel(e)?l(e):s.isString(e)?function(t){return t.get(e)}:e},l=function(e){var t=s.matches(e);return function(e){return t(e.attributes)}},h=t.Events={},c=/\s+/,u=function(e,t,i,n,r){var o,a=0;if(i&&"object"==typeof i){void 0!==n&&"context"in r&&void 0===r.context&&(r.context=n);for(o=s.keys(i);a<o.length;a++)t=u(e,t,o[a],i[o[a]],r)}else if(i&&c.test(i))for(o=i.split(c);a<o.length;a++)t=e(t,o[a],n,r);else t=e(t,i,n,r);return t};h.on=function(e,t,s){return d(this,e,t,s)};var d=function(e,t,s,i,n){return e._events=u(m,e._events||{},t,s,{context:i,ctx:e,listening:n}),n&&((e._listeners||(e._listeners={}))[n.id]=n),e};h.listenTo=function(e,t,i){if(!e)return this;var n=e._listenId||(e._listenId=s.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),o=r[n];if(!o){var a=this._listenId||(this._listenId=s.uniqueId("l"));o=r[n]={obj:e,objId:n,id:a,listeningTo:r,count:0}}return d(e,t,i,this,o),this};var m=function(e,t,s,i){if(s){var n=e[t]||(e[t]=[]),r=i.context,o=i.ctx,a=i.listening;a&&a.count++,n.push({callback:s,context:r,ctx:r||o,listening:a})}return e};h.off=function(e,t,s){return this._events?(this._events=u(_,this._events,e,t,{context:s,listeners:this._listeners}),this):this},h.stopListening=function(e,t,i){var n=this._listeningTo;if(!n)return this;for(var r=e?[e._listenId]:s.keys(n),o=0;o<r.length;o++){var a=n[r[o]];if(!a)break;a.obj.off(t,i,this)}return s.isEmpty(n)&&(this._listeningTo=void 0),this};var _=function(e,t,i,n){if(e){var r,o=0,a=n.context,l=n.listeners;if(t||i||a){for(var h=t?[t]:s.keys(e);o<h.length;o++){var c=e[t=h[o]];if(!c)break;for(var u=[],d=0;d<c.length;d++){var m=c[d];i&&i!==m.callback&&i!==m.callback._callback||a&&a!==m.context?u.push(m):(r=m.listening)&&0==--r.count&&(delete l[r.id],delete r.listeningTo[r.objId])}u.length?e[t]=u:delete e[t]}return s.size(e)?e:void 0}for(var _=s.keys(l);o<_.length;o++)delete l[(r=l[_[o]]).id],delete r.listeningTo[r.objId]}};h.once=function(e,t,i){var n=u(f,{},e,t,s.bind(this.off,this));return this.on(n,void 0,i)},h.listenToOnce=function(e,t,i){var n=u(f,{},t,i,s.bind(this.stopListening,this,e));return this.listenTo(e,n)};var f=function(e,t,i,n){if(i){var r=e[t]=s.once((function(){n(t,r),i.apply(this,arguments)}));r._callback=i}return e};h.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),s=Array(t),i=0;i<t;i++)s[i]=arguments[i+1];return u(g,this._events,e,void 0,s),this};var g=function(e,t,s,i){if(e){var n=e[t],r=e.all;n&&r&&(r=r.slice()),n&&p(n,i),r&&p(r,[t].concat(i))}return e},p=function(e,t){var s,i=-1,n=e.length,r=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;++i<n;)(s=e[i]).callback.call(s.ctx);return;case 1:for(;++i<n;)(s=e[i]).callback.call(s.ctx,r);return;case 2:for(;++i<n;)(s=e[i]).callback.call(s.ctx,r,o);return;case 3:for(;++i<n;)(s=e[i]).callback.call(s.ctx,r,o,a);return;default:for(;++i<n;)(s=e[i]).callback.apply(s.ctx,t);return}};h.bind=h.on,h.unbind=h.off,s.extend(t,h);var v=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=s.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=s.defaults({},i,s.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};s.extend(v.prototype,h,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!s.iteratee(e,this)(this.attributes)},set:function(e,t,i){if(null==e)return this;var n;if("object"==typeof e?(n=e,i=t):(n={})[e]=t,i||(i={}),!this._validate(n,i))return!1;var r=i.unset,o=i.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=s.clone(this.attributes),this.changed={});var h=this.attributes,c=this.changed,u=this._previousAttributes;for(var d in n)t=n[d],s.isEqual(h[d],t)||a.push(d),s.isEqual(u[d],t)?delete c[d]:c[d]=t,r?delete h[d]:h[d]=t;if(this.id=this.get(this.idAttribute),!o){a.length&&(this._pending=i);for(var m=0;m<a.length;m++)this.trigger("change:"+a[m],this,h[a[m]],i)}if(l)return this;if(!o)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&s.clone(this.changed);var t=this._changing?this._previousAttributes:this.attributes,i={};for(var n in e){var r=e[n];s.isEqual(t[n],r)||(i[n]=r)}return!!s.size(i)&&i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){e=s.extend({parse:!0},e);var t=this,i=e.success;return e.success=function(s){var n=e.parse?t.parse(s,e):s;if(!t.set(n,e))return!1;i&&i.call(e.context,t,s,e),t.trigger("sync",t,s,e)},F(this,e),this.sync("read",this,e)},save:function(e,t,i){var n;null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t;var r=(i=s.extend({validate:!0,parse:!0},i)).wait;if(n&&!r){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;var o=this,a=i.success,l=this.attributes;i.success=function(e){o.attributes=l;var t=i.parse?o.parse(e,i):e;if(r&&(t=s.extend({},n,t)),t&&!o.set(t,i))return!1;a&&a.call(i.context,o,e,i),o.trigger("sync",o,e,i)},F(this,i),n&&r&&(this.attributes=s.extend({},l,n));var h=this.isNew()?"create":i.patch?"patch":"update";"patch"!==h||i.attrs||(i.attrs=n);var c=this.sync(h,this,i);return this.attributes=l,c},destroy:function(e){e=e?s.clone(e):{};var t=this,i=e.success,n=e.wait,r=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(s){n&&r(),i&&i.call(e.context,t,s,e),t.isNew()||t.trigger("sync",t,s,e)};var o=!1;return this.isNew()?s.defer(e.success):(F(this,e),o=this.sync("delete",this,e)),n||r(),o},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||N();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},s.defaults({validate:!0},e))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return!i||(this.trigger("invalid",this,i,s.extend(t,{validationError:i})),!1)}}),o(v,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var y=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))},w={add:!0,remove:!0,merge:!0},b={add:!0,remove:!1},E=function(e,t,s){s=Math.min(Math.max(s,0),e.length);for(var i=Array(e.length-s),n=t.length,r=0;r<i.length;r++)i[r]=e[r+s];for(r=0;r<n;r++)e[r+s]=t[r];for(r=0;r<i.length;r++)e[r+n+s]=i[r]};s.extend(y.prototype,h,{model:v,initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,s.extend({merge:!1},t,b))},remove:function(e,t){t=s.extend({},t);var i=!s.isArray(e);e=i?[e]:s.clone(e);var n=this._removeModels(e,t);return!t.silent&&n&&this.trigger("update",this,t),i?n[0]:n},set:function(e,t){if(null!=e){(t=s.defaults({},t,w)).parse&&!this._isModel(e)&&(e=this.parse(e,t));var i=!s.isArray(e);e=i?[e]:e.slice();var n=t.at;null!=n&&(n=+n),n<0&&(n+=this.length+1);for(var r,o=[],a=[],l=[],h={},c=t.add,u=t.merge,d=t.remove,m=!1,_=this.comparator&&null==n&&!1!==t.sort,f=s.isString(this.comparator)?this.comparator:null,g=0;g<e.length;g++){r=e[g];var p=this.get(r);if(p){if(u&&r!==p){var v=this._isModel(r)?r.attributes:r;t.parse&&(v=p.parse(v,t)),p.set(v,t),_&&!m&&(m=p.hasChanged(f))}h[p.cid]||(h[p.cid]=!0,o.push(p)),e[g]=p}else c&&(r=e[g]=this._prepareModel(r,t))&&(a.push(r),this._addReference(r,t),h[r.cid]=!0,o.push(r))}if(d){for(g=0;g<this.length;g++)h[(r=this.models[g]).cid]||l.push(r);l.length&&this._removeModels(l,t)}var y=!1,b=!_&&c&&d;if(o.length&&b?(y=this.length!=o.length||s.some(this.models,(function(e,t){return e!==o[t]})),this.models.length=0,E(this.models,o,0),this.length=this.models.length):a.length&&(_&&(m=!0),E(this.models,a,null==n?this.length:n),this.length=this.models.length),m&&this.sort({silent:!0}),!t.silent){for(g=0;g<a.length;g++)null!=n&&(t.index=n+g),(r=a[g]).trigger("add",r,this,t);(m||y)&&this.trigger("sort",this,t),(a.length||l.length)&&this.trigger("update",this,t)}return i?e[0]:e}},reset:function(e,t){t=t?s.clone(t):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,s.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,s.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return r.apply(this.models,arguments)},get:function(e){if(null!=e){var t=this.modelId(this._isModel(e)?e.attributes:e);return this._byId[e]||this._byId[t]||this._byId[e.cid]}},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var i=t.length;return s.isFunction(t)&&(t=s.bind(t,this)),1===i||s.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return s.invoke(this.models,"get",e)},fetch:function(e){var t=(e=s.extend({parse:!0},e)).success,i=this;return e.success=function(s){var n=e.reset?"reset":"set";i[n](s,e),t&&t.call(e.context,i,s,e),i.trigger("sync",i,s,e)},F(this,e),this.sync("read",this,e)},create:function(e,t){var i=(t=t?s.clone(t):{}).wait;if(!(e=this._prepareModel(e,t)))return!1;i||this.add(e,t);var n=this,r=t.success;return t.success=function(e,t,s){i&&n.add(e,s),r&&r.call(s.context,e,t,s)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?s.clone(t):{}).collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeModels:function(e,t){for(var s=[],i=0;i<e.length;i++){var n=this.get(e[i]);if(n){var r=this.indexOf(n);this.models.splice(r,1),this.length--,t.silent||(t.index=r,n.trigger("remove",n,this,t)),s.push(n),this._removeReference(n,t)}}return!!s.length&&s},_isModel:function(e){return e instanceof v},_addReference:function(e,t){this._byId[e.cid]=e;var s=this.modelId(e.attributes);null!=s&&(this._byId[s]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var s=this.modelId(e.attributes);null!=s&&delete this._byId[s],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,s,i){if("add"!==e&&"remove"!==e||s===this){if("destroy"===e&&this.remove(t,i),"change"===e){var n=this.modelId(t.previousAttributes()),r=this.modelId(t.attributes);n!==r&&(null!=n&&delete this._byId[n],null!=r&&(this._byId[r]=t))}this.trigger.apply(this,arguments)}}}),o(y,{forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3},"models");var x=t.View=function(e){this.cid=s.uniqueId("view"),s.extend(this,s.pick(e,C)),this._ensureElement(),this.initialize.apply(this,arguments)},k=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];s.extend(x.prototype,h,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=s.result(this,"events")),!e)return this;for(var t in this.undelegateEvents(),e){var i=e[t];if(s.isFunction(i)||(i=this[i]),i){var n=t.match(k);this.delegate(n[1],n[2],s.bind(i,this))}}return this},delegate:function(e,t,s){return this.$el.on(e+".delegateEvents"+this.cid,t,s),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,s){return this.$el.off(e+".delegateEvents"+this.cid,t,s),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"));else{var e=s.extend({},s.result(this,"attributes"));this.id&&(e.id=s.result(this,"id")),this.className&&(e.class=s.result(this,"className")),this.setElement(this._createElement(s.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,i,n){var r=O[e];s.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:r,dataType:"json"};if(n.url||(o.url=s.result(i,"url")||N()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){o.type="POST",n.emulateJSON&&(o.data._method=r);var a=n.beforeSend;n.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",r),a)return a.apply(this,arguments)}}"GET"===o.type||n.emulateJSON||(o.processData=!1);var l=n.error;n.error=function(e,t,s){n.textStatus=t,n.errorThrown=s,l&&l.call(n.context,e,t,s)};var h=n.xhr=t.ajax(s.extend(o,n));return i.trigger("request",i,h,n),h};var O={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var j=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},P=/\((.*?)\)/g,A=/(\(\?)?:\w+/g,S=/\*\w+/g,M=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(j.prototype,h,{initialize:function(){},route:function(e,i,n){s.isRegExp(e)||(e=this._routeToRegExp(e)),s.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var r=this;return t.history.route(e,(function(s){var o=r._extractParameters(e,s);!1!==r.execute(n,o,i)&&(r.trigger.apply(r,["route:"+i].concat(o)),r.trigger("route",i,o),t.history.trigger("route",r,i,o))})),this},execute:function(e,t,s){e&&e.apply(this,t)},navigate:function(e,s){return t.history.navigate(e,s),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(M,"\\$&").replace(P,"(?:$1)?").replace(A,(function(e,t){return t?e:"([^/?]+)"})).replace(S,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return s.map(i,(function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null}))}});var T=t.History=function(){this.handlers=[],this.checkUrl=s.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,B=/#.*$/;T.started=!1,s.extend(T.prototype,h,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(I,"")},start:function(e){if(T.started)throw new Error("Backbone.history has already been started");if(T.started=!0,this.options=s.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(D,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,n=i.insertBefore(this.iframe,i.firstChild).contentWindow;n.document.open(),n.document.close(),n.location.hash="#"+this.fragment}var r=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),T.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),s.some(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0})))},navigate:function(e,t){if(!T.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");var s=this.root;""!==e&&"?"!==e.charAt(0)||(s=s.slice(0,-1)||"/");var i=s+e;if(e=this.decodeFragment(e.replace(B,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var n=this.iframe.contentWindow;t.replace||(n.document.open(),n.document.close()),this._updateHash(n.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,s){if(s){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new T;v.extend=y.extend=j.extend=x.extend=T.extend=function(e,t){var i,n=this;i=e&&s.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,t);var r=function(){this.constructor=i};return r.prototype=n.prototype,i.prototype=new r,e&&s.extend(i.prototype,e),i.__super__=n.prototype,i};var N=function(){throw new Error('A "url" property or function must be specified')},F=function(e,t){var s=t.error;t.error=function(i){s&&s.call(t.context,e,i,t),e.trigger("error",e,i,t)}};return t}(r,s,e,t)}.apply(t,i),void 0===n||(e.exports=n)}}]);